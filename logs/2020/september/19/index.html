<!doctype html><html lang=en class=h-100><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.62.2"><link rel=stylesheet href=https://puneethapai.github.io/css/bootstrap.min.css><title>September 19, 2020 | Puneeth</title><style>.container{max-width:700px}#nav a{font-weight:700;color:inherit}#nav a.nav-link-active{background-color:#212529;color:#fff}#nav-border{border-bottom:1px solid #212529}#main{margin-top:1em;margin-bottom:4em}#home-jumbotron{background-color:inherit}#footer .container{padding:1em 0}#footer a{color:inherit;text-decoration:underline}.font-125{font-size:125%}.tag-btn{margin-bottom:.3em}pre{background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px;padding:16px}pre code{padding:0;font-size:inherit;color:inherit;background-color:transparent;border-radius:0}code{padding:2px 4px;font-size:90%;color:#c7254e;background-color:#f9f2f4;border-radius:4px}img,iframe,embed,video,audio{max-width:100%}.card-img,.card-img-top,.card-img-bottom{width:initial}</style></head><body class="d-flex flex-column h-100"><div id=nav-border class=container><nav id=nav class="nav justify-content-center"><a class=nav-link href=/><i data-feather=home></i>Home</a>
<a class=nav-link href=/blogs/><i data-feather=edit></i>Blog</a>
<a class=nav-link href=/categories/><i data-feather=tag></i>Categories</a>
<a class=nav-link href=/tags/><i data-feather=tag></i>Tags</a>
<a class=nav-link href=/about/><i data-feather=smile></i>About</a>
<a class=nav-link href=/index.xml><i data-feather=rss></i>RSS</a></nav></div><div class=container><main id=main><h1>September 19, 2020</h1><h2 id=csv-dict-writer>CSV dict writer:</h2><p>Dict Reader and Writer are most flexible ways to manipulate csv data.</p><p>Both reader and writer supports <strong>generators</strong> and hence can work in <strong>low memory systems</strong> pretty efficiently.</p><h4 id=example>Example:</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> csv
<span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> Iterable, Dict


<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>read_csv</span>(path: str) <span style=color:#f92672>-</span><span style=color:#f92672>&gt;</span> Iterable[Dict]:
    <span style=color:#e6db74></span><span style=color:#e6db74>&#34;&#34;&#34;</span><span style=color:#e6db74>Reads csv and yeilds row as dict</span><span style=color:#e6db74>&#34;&#34;&#34;</span>
    <span style=color:#66d9ef>with</span> open(path, <span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>r</span><span style=color:#e6db74>&#34;</span>, newline<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>&#34;</span>) <span style=color:#66d9ef>as</span> f:
        reader <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>DictReader(f)
        <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> reader:
            <span style=color:#66d9ef>yield</span> row


<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>write_csv</span>(path: str, data: Iterable[Dict], header: list <span style=color:#f92672>=</span> None) <span style=color:#f92672>-</span><span style=color:#f92672>&gt;</span> None:
    <span style=color:#e6db74></span><span style=color:#e6db74>&#34;&#34;&#34;</span><span style=color:#e6db74>Writes data: Iterable[Dict] into csv file</span><span style=color:#e6db74>&#34;&#34;&#34;</span>
    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> header:
        header <span style=color:#f92672>=</span> data[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>keys()
    <span style=color:#66d9ef>with</span> open(path, <span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>w+</span><span style=color:#e6db74>&#34;</span>, newline<span style=color:#f92672>=</span><span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>&#34;</span>) <span style=color:#66d9ef>as</span> f:
        writer <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>DictWriter(f, header)
        writer<span style=color:#f92672>.</span>writeheader()
        writer<span style=color:#f92672>.</span>writerows(data)
</code></pre></div><h2 id=subprocess>Subprocess:</h2><p>Subprocess run with <code>shell=True</code> sucks for some reason. This may be because, certain commands
opens up temporory buff file as output like commands <code>less</code>, <code>man</code>, <code>git log</code>, etc. Following
is a pretty handy subprocess execution for any command.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> List
<span style=color:#f92672>import</span> subporcess <span style=color:#f92672>as</span> sp

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_process_output</span>(command: List[str], timeout: int <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>) <span style=color:#f92672>-</span><span style=color:#f92672>&gt;</span> str:
    <span style=color:#e6db74></span><span style=color:#e6db74>&#34;&#34;&#34;</span><span style=color:#e6db74>Executes command and returns it</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>s execution output</span><span style=color:#e6db74>&#34;&#34;&#34;</span>
    <span style=color:#66d9ef>try</span>:
        process <span style=color:#f92672>=</span> sp<span style=color:#f92672>.</span>run(command, timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>, text<span style=color:#f92672>=</span>True, stdout<span style=color:#f92672>=</span>sp<span style=color:#f92672>.</span>PIPE, stderr<span style=color:#f92672>=</span>sp<span style=color:#f92672>.</span>PIPE)
        <span style=color:#66d9ef>return</span> process<span style=color:#f92672>.</span>stdout <span style=color:#66d9ef>if</span> process<span style=color:#f92672>.</span>returncode <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> process<span style=color:#f92672>.</span>stderr
    <span style=color:#66d9ef>except</span> sp<span style=color:#f92672>.</span>SubprocessError <span style=color:#66d9ef>as</span> e:
        <span style=color:#66d9ef>return</span> str(e)
</code></pre></div><h2 id=pathlibpath>pathlib.Path</h2><p>Really handy path library. Some useful methods are:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> pathlib <span style=color:#f92672>import</span> Path

path <span style=color:#f92672>=</span> Path(<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>some/path/</span><span style=color:#e6db74>&#34;</span>)

<span style=color:#75715e># File/Folder Name</span>
path<span style=color:#f92672>.</span>name 

<span style=color:#75715e># Read</span>
path<span style=color:#f92672>.</span>read_text()
path<span style=color:#f92672>.</span>read_bytes()

<span style=color:#75715e># Write</span>
path<span style=color:#f92672>.</span>write_text(<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>data</span><span style=color:#e6db74>&#34;</span>)
path<span style=color:#f92672>.</span>write_bytes(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>data</span><span style=color:#e6db74>&#34;</span>)

<span style=color:#75715e># Navigation</span>
path <span style=color:#f92672>/</span> <span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>some/other/file</span><span style=color:#e6db74>&#34;</span>
path <span style=color:#f92672>/</span> <span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>some</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>/</span> <span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>other</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>/</span> <span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>file</span><span style=color:#e6db74>&#34;</span>

<span style=color:#75715e># Listing all files</span>
paths_matching_pattern <span style=color:#f92672>=</span> path<span style=color:#f92672>.</span>glob(<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>*pattern*</span><span style=color:#e6db74>&#34;</span>) <span style=color:#75715e># Eg: *.csv, *.md, *.jpg, etc</span>
all_files <span style=color:#f92672>=</span> list(path<span style=color:#f92672>.</span>iterdir()) <span style=color:#75715e># List all files and folders in `path`</span>

<span style=color:#66d9ef>assert</span> list(path<span style=color:#f92672>.</span>glob(<span style=color:#e6db74></span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>*</span><span style=color:#e6db74>&#34;</span>)) <span style=color:#f92672>==</span> list(path<span style=color:#f92672>.</span>iterdir()) <span style=color:#75715e># True</span>
</code></pre></div></main></div><footer id=footer class="mt-auto text-center text-muted"><div class=container>Made with <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/zwbetz-gh/vanilla-bootstrap-hugo-theme>Vanilla</a></div></footer><script src=https://puneethapai.github.io/js/feather.min.js></script><script>feather.replace()</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body);></script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-171271234-1','auto');ga('send','pageview');</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>